Google timeline.alfredworkflowのメモ

機能：
　特定の日付のgoogle timelineを表示させる

インストール：
　1.alfredworkflowをダウンロード
　2.ファイルをダブルクリックしてワークフローに登録

使い方：
　Alfredからキーワードで起動
　gt {yyyymmdd}
　または
　場所 {yyyymmdd}

　※私がalfredを日本語でweb検索に使うことが多いので、キーワードも日本語をつけてみました
　”アリバイ”みたいなキーワードが良いかも。。。


開発メモ：

1.英語と日本語のキーワードで起動させる

　RunScriptのインプットとなるキーワードを2つ繋げるだけでOKです
　パラメータが全角の場合があることを考慮して、スクリプトで半角化しています

2.全角数字を半角に変換する

　Sedコマンドで変換しています
　数字だけなので、見た目でわかりやすいスクリプトですね
　よく見る例では0〜9と並べていますが、9〜0としてみました。もちろん動きます

　sed 'y/９８７６５４３２１０/9876543210/'

3.コマンドの結果を変数に格納する

　バックスラッシュで囲むとコマンドの結果を変数に代入できます
　コードの先頭で、query=$1としてパラメータを取得する部分をechoとsedで半角化しています

　query=`echo $1|sed 'y/９８７６５４３２１０/9876543210/'`

　ちなみに私はUK配列キーボードなので`が簡単に入力できます

4.文字列の部分参照

　timelineのURLに必要なyyyy-mm-ddを作成する際にパラメータを部分参照します。
　queryにyyyymmdd形式で数字が入っている想定です
　
　＄{query:0:4}"-"${query:4:2}"-"${query:6:2}

　これはyyyymmddからyyyy-mm-ddを作り出していますが、部分参照の構文は　{変数:開始位置:長さ}　となります
　開始位置は先頭が0となります

　※ちなみにyyyy-mm-ddとしてユーザーから入力させる場合は、FeaturesのWeb Searchのカスタム検索で実現できます。
　　”-”をユーザーに書かせない点が、実はこのワークフローの肝なのです

5.URLを開く
　workflowの後続を使わずにスクリプトからOPENをしてみました
　英数字だけのURLならopenで良さそうです。（日本語がある場合は%エンコードが必要になりそうです）


背景：
　趣味で一眼レフを使って風景写真を撮っています
　写真の位置情報はスマホから取得する筈なのですが、スナップショットが多いせいか、
　スマホとカメラが連携する前に撮影が終わってしまいます
　撮影日から訪れた場所を確認するためにこのツールを作ってみました

